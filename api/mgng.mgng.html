
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>mgng.mgng module &#8212; mgng 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mgng.validators module" href="mgng.validators.html" />
    <link rel="prev" title="mgng.helpers module" href="mgng.helpers.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-mgng.mgng">
<span id="mgng-mgng-module"></span><h1>mgng.mgng module<a class="headerlink" href="#module-mgng.mgng" title="Permalink to this headline">¶</a></h1>
<p>Implementation of the Merged Growing Neural Gas for temporal data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">mgng.mgng.</span></span><span class="sig-name descname"><span class="pre">MergeGNG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_neurons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporal_influence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">life_span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_rate_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decrease_activity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_activity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_removal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">creation_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that represents a Merge Growing Neural Gas.</p>
<p>Differences to default implementation</p>
<ul class="simple">
<li><p>Neurons all kept in memory to allow numpy operations</p></li>
<li><p>Introduce half life and threshold for connections (planned). For now, only decrease.</p></li>
<li><p>Adaptation rate should depend on connection strength</p></li>
<li><p>Introduce method (half-life?, decay on all synapses) to remove very old movements (I am sure that the original implementation allows for orphans)</p></li>
<li><p>Compare with an approach of a regular neural gas with a refactory time</p></li>
<li><p>Add threshold for an activity to trigger a new neuron (hey, make a fifo). I really want to enforce this. If a neuron gets activated 3 times in a row it’s tiem for a new neuron!</p></li>
<li><p>REALLY CONSIDER REMOVING THE DIOGONAL ELEMENTS! Implement neighbor learn rate .. maybe weighted by synapse strength</p></li>
<li><p>Activity is never 0 unless it is a never used neuron or one removed because it had no connections</p></li>
<li><p>Todo: did we remove neurons without connections?</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_neurons</strong> (<em>int</em>) – Max. number of neurons</p></li>
<li><p><strong>n_dim</strong> (<em>int</em>) – Output dimension (of the feature space).</p></li>
<li><p><strong>connection_decay</strong> (<em>float</em>) – Hyper parameter for influencing the decay of neuron connections. NOT USED RIGHT NOW</p></li>
<li><p><strong>temporal_influence</strong> (<em>float</em>) – The influence of the temporal memory on finding the winning neuron</p></li>
<li><p><strong>memory_weight</strong> (<em>float</em>) – Determines the influence of past samples in the sequence. (Kinda “how long” it looks back into the past).</p></li>
<li><p><strong>life_span</strong> (<em>int</em>) – How many iterations until a synapse is deleted.
Note .. synapses of the winning neuron only are decayed (it forgets “wrong” neighbors)</p></li>
<li><p><strong>max_activity</strong> – Maximal activity allowed for a neuron (cf. refractory period). If a neuron is more active than this threshold,
a new neuron is inserted between it and the second most active neuron. Note that each time the neuron is the
winning neuron, it’s activity level is increased by 1.0 and then continuously decreases continuously in
each iteration (c.f. <cite>decrease_activity</cite>)
This is different to the reference paper where the network gros in regular intervals.
Our approach reflects a more “on demand” approach and prevents the network from growing unnecessarily.</p></li>
<li><p><strong>decrease_activity</strong> (<em>float</em>) – Less important .. the activity decreases exponentially … only interesting if there are only few iterations
between reccuring sequences</p></li>
<li><p><strong>learn_rate</strong> (<em>float</em>) – lorem ipsum</p></li>
<li><p><strong>learn_rate_neighbors</strong> (<em>float</em>) – lorem ipsum</p></li>
<li><p><strong>delta</strong> (<em>float</em>) – Need a better name, right? It’s a parameter that decides the neuron’s activity if a new neuron is added.</p></li>
<li><p><strong>allow_removal</strong> (<em>float</em>) – lorem ipsum</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._weights">
<span class="sig-name descname"><span class="pre">_weights</span></span><a class="headerlink" href="#mgng.mgng.MergeGNG._weights" title="Permalink to this definition">¶</a></dt>
<dd><p>The amount of neurons is constant in this implementation for simplicity
reasons and speed (block operations).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, <span class="math notranslate nohighlight">\(n_{\text{neurons}} \times n_{\text{dim}}\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._default_weights">
<span class="sig-name descname"><span class="pre">_default_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG._default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG._default_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._default_context">
<span class="sig-name descname"><span class="pre">_default_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG._default_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG._default_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._default_global_context">
<span class="sig-name descname"><span class="pre">_default_global_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG._default_global_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG._default_global_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._default_connections">
<span class="sig-name descname"><span class="pre">_default_connections</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG._default_connections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG._default_connections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._default_counter">
<span class="sig-name descname"><span class="pre">_default_counter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG._default_counter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG._default_counter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG._decay">
<span class="sig-name descname"><span class="pre">_decay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG._decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG._decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrease all synapses of a neuron but don’t allow negative synampses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>first</strong> (<em>int</em>) – Index of the neuron</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG.kill_orphans">
<span class="sig-name descname"><span class="pre">kill_orphans</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG.kill_orphans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG.kill_orphans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG.adapt">
<span class="sig-name descname"><span class="pre">adapt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><span class="pre">numpy.ndarray</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG.adapt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG.adapt" title="Permalink to this definition">¶</a></dt>
<dd><p>Single adaptation step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sample</strong> (np.ndarray, shape: <span class="math notranslate nohighlight">\((n_{ ext{dim}},)\)</span>) – A single sample.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Optionally returns the first and second winning
neurons used for Hebbian learning.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[int,int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG.grow">
<span class="sig-name descname"><span class="pre">grow</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG.grow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG.grow" title="Permalink to this definition">¶</a></dt>
<dd><p>Entropy maximization by adding neurons in regions of high activity.</p>
<p>Note: this picks the weakest neuron. TODO this needs to be implemented too!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG.kill_weakest">
<span class="sig-name descname"><span class="pre">kill_weakest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.signedinteger" title="(in NumPy v1.20)"><span class="pre">numpy.signedinteger</span></a><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG.kill_weakest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG.kill_weakest" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the weakest neuron (or the first with zero activity in the list)
and returns its index</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Index of the neuron</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><span class="pre">numpy.ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch learning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em>) – Row array of points. Shape <span class="math notranslate nohighlight">\(n_{\text{samples}} \times n_{\text{dim}}\)</span>.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of repetitions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgng.mgng.MergeGNG.get_active_weights">
<span class="sig-name descname"><span class="pre">get_active_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgng/mgng.html#MergeGNG.get_active_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgng.mgng.MergeGNG.get_active_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">mgng</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../merge_growing_neural_gas.html">The Growing Neural Gas and Merge Growing Neural Gas Algorithms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">mgng</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mgng.html">mgng package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">mgng</a><ul>
  <li><a href="mgng.html">mgng package</a><ul>
      <li>Previous: <a href="mgng.helpers.html" title="previous chapter">mgng.helpers module</a></li>
      <li>Next: <a href="mgng.validators.html" title="next chapter">mgng.validators module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Stefan Ulbrich.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/api/mgng.mgng.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>